import{d as T,r as m,l as p,m as w,n as E,o as c,c as u,a as o,q as x,F as _,x as C,k as R,y,p as N,e as k}from"./index-81b1c270.js";import{_ as B}from"./plugin-vue_export-helper-c27b6911.js";const S=s=>(N("data-v-6319718a"),s=s(),k(),s),A={class:"tag-box"},V=S(()=>o("div",{class:"label"},"标签输入框:",-1)),D={class:"content"},F=["id"],K={class:"tag-box"},P=["onClick"],$=T({__name:"tagInput",setup(s){const t=m({contentId:"content1",currentText:"",currentTagId:null,savedRange:null}),r=p(),I=m([{name:"标签一",id:1},{name:"标签二",id:2},{name:"标签三",id:3}]),i=p(),h=[{value:"1",label:"Level one 1",children:[{value:"1-1",label:"Level two 1-1",children:[{value:"1-1-1",label:"Level three 1-1-1"}]}]},{value:"2",label:"Level one 2",children:[{value:"2-1",label:"Level two 2-1",children:[{value:"2-1-1",label:"Level three 2-1-1"}]},{value:"2-2",label:"Level two 2-2",children:[{value:"2-2-1",label:"Level three 2-2-1"}]}]},{value:"3",label:"Level one 3",children:[{value:"3-1",label:"Level two 3-1",children:[{value:"3-1-1",label:"Level three 3-1-1"}]},{value:"3-2",label:"Level two 3-2",children:[{value:"3-2-1",label:"Level three 3-2-1"}]}]}],v=()=>{const a=window.getSelection(),e=a.rangeCount>0?a.getRangeAt(0):null;e&&e.commonAncestorContainer.ownerDocument.activeElement.id===t.contentId&&(t.savedRange=e)};w(()=>{document.addEventListener("selectionchange",v)});const g=a=>{t.currentText=a.innerText},f=a=>{t.savedRange||(r.value.focus(),v());const e=document.createElement("span");if(e.innerText=`<${a}>`,t.savedRange.commonAncestorContainer.parentElement.nodeName==="SPAN")return;t.savedRange.deleteContents(),t.savedRange.insertNode(e);const l=r.value;t.currentText=l.innerText;const n=window.getSelection(),d=t.savedRange.cloneRange();d.setStartAfter(e),d.collapse(!1),n.removeAllRanges(),n.addRange(d)},b=a=>{if(t.currentTagId){const e=document.getElementById(t.currentTagId);r.value.removeChild(e),t.currentTagId=null,a.preventDefault(),g(a.target)}},L=a=>{if(a.target.nodeName==="SPAN")t.currentTagId=a.target.id;else if(t.currentTagId){const l=document.getElementById(t.currentTagId);l.className="",t.currentTagId=null}else t.currentTagId=null};return(a,e)=>{const l=E("el-tree-select");return c(),u(_,null,[o("div",A,[V,o("div",D,[o("div",{id:t.contentId,ref_key:"root",ref:r,class:"tag-input",onInput:e[0]||(e[0]=n=>g(n.target)),onKeydown:e[1]||(e[1]=x(n=>b(n),["delete"])),onClick:e[2]||(e[2]=n=>L(n))},null,40,F),o("div",K,[(c(!0),u(_,null,C(I,n=>(c(),u("span",{key:n.name,class:"one-tag",onClick:d=>f(n.name)},y(n.name),9,P))),128))])])]),R(l,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=n=>i.value=n),data:h,"show-all-levels":!0},null,8,["modelValue"])],64)}}}),M=B($,[["__scopeId","data-v-6319718a"]]);export{M as default};
